<form
  *ngIf="form"
  [formGroup]="form"
  (submit)="onSubmit()"
  class="offer-detail"
>  

<div class="container-fluid sticky-top bg-white mb-42px" style="height: 72px;">
  <div class="row align-items-center h-100 border-bottom border-secondary">
    <div class="col pl-0 h-100">
      <button type="button" class="btn bg-white px-2 h-100 rounded-0" style="width: 102px;"
        (click)="onClose()">
        <app-icon icon="close"></app-icon>
      </button>
    </div>
    <div class="col-auto font-size-20 font-family-bold text-dark">
      პროდუქტის {{ title }}
    </div>
    <div class="col pr-4 h-100 d-flex align-items-center justify-content-end">
      <button class="btn btn-primary font-size-14 font-family-bold text-white py-0 px-23px h-42px"
        type="submit">
        შენახვა
      </button>
    </div>
  </div>
</div>

<div class="w-100" *ngIf="isSubmited && form?.invalid">
  <div class="mx-auto bg-danger-bg px-4 rounded text-center border d-flex align-items-center border-danger-border mt-3"
    style="max-width: 960px;height: 54px;">
    <div class="col-2 d-flex px-0">
      <app-icon icon="alert"></app-icon>
    </div>
    <div class="col text-center font-size-14 font-color-dark font-family-regular">
      შეავსე გამორჩენილი ველები
    </div>
    <div class="col-2 px-0"></div>
  </div>
</div>
  

  <div class="container-md d-flex pt-5">
    <div class="pl-0 col-8">
      <div class="w-100 d-flex flex-column pb-32px">
        <label class="font-size-15 font-color-dark font-family-bold"
          >დასახელება*</label
        >
        <input class="form-control" type="text" formControlName="name" />
      </div>
      <div class="w-100 d-flex flex-column pb-32px">
        <label class="font-size-15 font-color-dark font-family-bold"
          >ბარკოდი*</label
        >
        <input class="form-control" type="text" formControlName="barcode" />
      </div>
      <div class="w-100 d-flex flex-column pb-32px">
        <label class="font-size-15 font-color-dark font-family-bold"
          >სურათის ლინკი</label
        >
        <input
          class="form-control"
          type="text"
          formControlName="photo"
          disabled
        />
        <a
          [href]="editCatalogue?.photoUrl"
          disabled="!editCatalogue"
          target="_blank"
          class="mt-2"
        >
          ლინკზე გადასვლა
        </a>
      </div>

      <!-- <div class="w-100 d-flex flex-column pb-32px">
        <label class="font-size-15 font-color-dark font-family-bold"
          >ინდუსტრიები</label
        >
          <app-dynamic-select
            id="businessType"
            class="add-inventory-item__dynamic-select"
            placeholder="აირჩიე"
            [dataGetter]="getBusinessTypes"
            [itemGetterById]="getBusinessTypeById"
            [closeOnSelect]="true"
            formControlName="businessTypes"
          >
          </app-dynamic-select>
      </div> -->

      <div class="w-100 d-flex flex-column pb-32px">
        <label class="font-size-15 font-color-dark font-family-bold"
          >კატეგორია</label
        >
        <input class="form-control" type="text" formControlName="category" />
      </div>

      <div class="w-100 d-flex flex-column pb-32px">
        <label class="font-size-15 font-color-dark font-family-bold">
          მომწოდებელი
        </label>
        <!-- <input class="form-control" type="text" formControlName="distributor" /> -->
        <!-- <app-dynamic-select
            id="businessType"
            class="add-inventory-item__dynamic-select"
            [dataGetter]="getDistributors"
            [itemGetterById]="getDistributorById"
            [closeOnSelect]="true"
            formControlName="distributor"
          >
          </app-dynamic-select> -->
          <app-dynamic-select
          
          #orderLineSelector
          class="add-inventory-item__dynamic-select input-pr-25px"
          placeholder="ჩაწერე"
          [dataGetter]="getDistributors"
          [itemGetterById]="getDistributorById"
          sortField="name"
          formControlName="distributor"
          additionalSearchKey="barcode"
        >
          <ng-template app-dynamic-select-option-tmp let-item="item">
            <div class="d-flex flex-column">
              <div class="font-size-14 font-color-dark font-family-bold pb-1 line-height-normal text-truncate">
                {{ item.name }}
              </div>
              <div class="font-size-14 font-color-dark font-family-regular  line-height-normal text-truncate">
                {{ item.inn }}
              </div>
            </div>
          </ng-template>
        </app-dynamic-select>
      </div>

      <div class="w-100 d-flex flex-column pb-32px">
        <label class="font-size-15 font-color-dark font-family-bold"
          >თვითღირებულება</label
        >
        <input class="form-control" type="number" formControlName="unitCost" />
      </div>
      <div class="w-100 d-flex flex-column pb-32px">
        <label class="font-size-15 font-color-dark font-family-bold"
          >გასაყიდი ფასი</label
        >
        <input class="form-control" type="number" formControlName="unitPrice" />
      </div>

      <div class="w-100 d-flex flex-column pb-32px">
        <label class="font-size-15 font-color-dark font-family-bold"
          >აღწერა</label
        >
        <input class="form-control" type="text" formControlName="description" />
      </div>

      <div class="w-100 d-flex flex-column pb-32px">
        <label
          class="font-size-15 font-color-dark font-family-bold"
          for="status"
          >სტატუსი*</label
        >

        <ng-select
          id="status"
          formControlName="status"
          [items]="catalogueStockitemStatus"
          placeholder="აირჩიე"
          bindValue="value"
          bindLabel="label"
          [searchable]="false"
          [clearable]="false"
          class="form-control"
        >
        </ng-select>
      </div>
    </div>

    <div class="col-4 pr-0 pt-28px">
      <div
        class="custom-file uploader-305-bg"
        style="height: 245px;max-width: 304px;"
        [ngClass]="{
          invalid: form.get('name').touched && form.get('name').invalid
        }"
      >
        <app-file-uploader
          id="offerDetailImage"
          class="h-100"
          [shownImage]="editCatalogue?.photoUrl"
          [uploadFileParamName]="'image'"
          [uploadEndpoint]="'uploads/images'"
          (uploaded)="onPhotoUploaded($event)"
          [emitFileName]="true"
        ></app-file-uploader>
      </div>
      <div class="pr-4 font-size-13 pt-3">
        მინიმალური დასაშვები ზომები 832x624px (.jpg, .jpeg, .png)
      </div>
    </div>
  </div>
</form>
