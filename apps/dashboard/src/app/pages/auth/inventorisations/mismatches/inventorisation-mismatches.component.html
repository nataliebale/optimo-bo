<ng-container *ngIf="item">
  <div
    class="container-fluid sticky-top bg-white "
    style="height: 72px;"
  >
    <div class="row align-items-center h-100 border-bottom border-secondary">
      <div class="col pl-0 h-100">
        <button
          type="button"
          class="btn bg-white px-2 h-100 rounded-0"
          style="width: 102px;"
          (click)="onCancel()"
        >
        <app-icon icon="close"></app-icon>
        </button>
      </div>
      <div class="col-auto font-size-20 font-family-bold text-dark">
        {{'Inventorisations.Mismatches.correct' | translate}}
      </div>
      <div class="col pr-4 h-100 d-flex align-items-center justify-content-end">
        <button
          class="btn btn-primary font-size-14 font-family-bold text-white py-0 px-23px h-42px"
          (click)="onConfirm()"
          [disabled]="requestIsSent"
        >
          {{'Inventorisations.Mismatches.confirm' | translate}}
        </button>
      </div>
    </div>
  </div>
  <div class="mt-3" style="height: 54px;" >
    <div class="w-100" *ngIf="isSubmited && isFormInvalid">
      <div  class="mx-auto bg-danger-bg py-20px px-4  rounded text-center border  d-flex align-items-center border-danger-border mt-3" style="max-width: 960px;height: 54px;">
       <div class="col-2 d-flex px-0"> <app-icon icon="alert"></app-icon></div>
       <div class="col text-center font-size-14 font-color-dark font-family-regular">შეავსე გამორჩენილი ველები</div>
       <div class="col-2 px-0"></div>
      </div>
    </div>
  </div>

  <!-- <div class="w-100" *ngIf="isSubmited && isFormInvalid">
		<div class="mx-auto bg-danger-bg px-4 rounded text-center border d-flex align-items-center border-danger-border mt-3"
			style="max-width: 960px;height: 54px;">
			<div class="col-2 d-flex px-0">
				<app-icon icon="alert"></app-icon>
			</div>
			<div class="col text-center font-size-14 font-color-dark font-family-regular">
				ატვირთულ ფაილში არსებული პროდუქტები არ შეესაბამება შენი პროდუქტების სიას.
			</div>
			<div class="col-2 px-0"></div>
    </div>
    <div class="mx-auto d-flex align-items-center justify-content-between" style="max-width: 960px;">
      <button (click)="onExcelDownload()" class="btn mx-4 mt-2 mb-4 btn-light-green px-4 font-size-14 font-color-white font-family-bold py-0" style="height: 48px;">
        <app-icon icon="excel" class="mr-2"></app-icon>
        ჩამოტვირთვა 
      </button>
       
        <div class="d-flex align-items-center p-4">
          <span
            class="bg-danger rounded-circle"
            style="width: 8px;height: 8px;"
          ></span>
          <div class="font-size-14 text-dark ml-2">
            ფორმაში არსებული შეუსაბამო პროდუქტები
          </div>
        </div>
       
    </div>
	</div> -->


  <!-- <div class="mt-4 w-100" *ngIf="isSubmited && isFormInvalid">
    <div class="mx-auto d-flex align-items-center justify-content-between" style="max-width: 960px;">
      <div class="font-size-14 font-color-dark font-family-regular">
        <span style="width: 7px;height: 7px;background-color: #e21331;" class="d-inline-block rounded-circle mr-2"> </span>
        <span>{{'Inventorisations.Mismatches.productWarningMessage' | translate}}</span>
      </div>
      <button class="rounded bg-light-green btn d-flex align-items-center" style="width: 192px;">
        <div class="col-2 px-0">
          <app-icon icon="excel"></app-icon>
        </div>
        <div class="col font-size-14 font-color-white  ">
			{{'Inventorisations.Mismatches.Download' | translate}}
        </div>
        <div class="col-2 px-0">
        </div>
      </button>
    </div>
  </div> -->
  <div class="pt-20px px-0 pb-68px mx-auto"
       style="max-width: 960px;"
  >
    <ng-container *ngIf="params.hasErrors">
      <div class="border rounded mb-4 bg-white">
        <div
          class="card-header text-primary bg-transparent font-family-medium p-4 text-danger"
        >
          <app-icon icon="alert" class="align-bottom"></app-icon>
          <span class="pl-2 text-danger font-size-16 font-family-semibold "
            >{{'Inventorisations.Mismatches.Carefully' | translate}}!</span
          >
        </div>
        <div
          class=" font-size-14 text-dark px-4 pt-4 pb-3 w-100"
          style="max-width: 490px;"
        >
		{{'Inventorisations.Mismatches.productErrorMessage' | translate}}
        </div>
        <button (click)="onExcelDownload()" class="btn mx-4 mt-2 mb-4 btn-light-green px-4 font-size-14 font-color-white font-family-bold py-0" style="height: 48px;">
          <app-icon icon="excel" class="mr-2"></app-icon>
          {{'Inventorisations.Mismatches.Download' | translate}}
        </button>
        <div class="border-top">
          <div class="d-flex align-items-center p-4">
            <span
              class="bg-yellow-light rounded-circle"
              style="width: 8px;height: 8px;"
            ></span>
            <div class="font-size-14 text-dark ml-2">
               
              {{'Inventorisations.Mismatches.dublicateWarningMessage' | translate}}
            </div>
          </div>
          <div class="d-flex align-items-center pr-4 pl-4 pb-4">
            <span
              class="bg-yellow-to-red rounded-circle"
              style="width: 8px;height: 8px;"
            ></span>
            <div class="font-size-14 text-dark ml-2">
              {{'Inventorisations.Mismatches.assortmentWarningMessage' | translate}}
            </div>
          </div>
          <div class="d-flex align-items-center pr-4 pl-4 pb-4">
            <span
              class="bg-red rounded-circle"
              style="width: 8px;height: 8px;"
            ></span>
            <div class="font-size-14 text-dark ml-2">
				{{'Inventorisations.Mismatches.productWarningMessage' | translate}}
            </div>
          </div>
        </div>
      </div>

      <ng-template #confirmPopupWithErrors>
        <app-icon icon="alert" class="icon-attention pb-4"></app-icon>

        <div class="font-size-14 text-dark px-4 pt-4 pb-3">
			{{'Inventorisations.Mismatches.productErrorMessage' | translate}}
        </div>
        <div
          class="d-inline-flex align-items-center mb-2 pb-4 px-4"
          (click)="onExcelDownload()"
          style="cursor: pointer;"
        >
          <app-icon icon="excel" class="mr-2"></app-icon>
          <span
            class="text-success font-size-14"
            style="text-decoration: underline;"
            >{{'Inventorisations.Mismatches.DownloadForm' | translate}}
          </span>
        </div>
        <div class="border-top p-4">
          <div class="d-flex align-items-center">
            <span
              class="bg-danger rounded-circle"
              style="width: 8px;height: 8px;"
            ></span>
            <div class="font-size-14 text-dark ml-2">
				{{'Inventorisations.Mismatches.productWarningMessage' | translate}}
            </div>
          </div>
        </div>
      </ng-template>
    </ng-container>

    <ng-container *ngIf="mismatches && mismatches.length">
      <app-table
        [dataSource]="mismatches"
        [totalCount]="mismatches.length"
        [selectable]="false"
        [filterable]="false"
        [paginable]="false"
        [displayedColumns]="displayedColumns"
        [staticData]="true"
        class="table-orders table-mismatch mt-2 dialog-overflow-visible last-td-pr-4"
      >
        <ng-template app-cell let-row="row" let-cell="cell" name="mismatch">
          <div class="text-truncate text-right">
            <span
              class="d-flex justify-content-end"
              [matTooltip]="
                (cell | number: '1.4-4':'en') +
                ' ' +
                getUMOAcronym(row.unitOfMeasurement)
			  "
			  #ref1 [matTooltipDisabled]="textIsTruncated(ref1)"
              
            >
            <!-- [ngClass]="{
                'text-danger': cell < 0,
                'text-success': cell > 0
              }" -->
              <span class="text-truncate"
                >{{ cell | number: '1.4-4':'en' }}
                {{ getUMOAcronym(row.unitOfMeasurement) }}</span
              >
            </span>
          </div>
        </ng-template>
        <ng-template app-cell let-row="row" name="reason">
          <div class="pr-4 w-100 unset-all">
            <ng-select
            #reason="ngModel"
            class="custom-select-header form-control"
            [items]="
              row.mismatch > 0
                ? MAP_OF_INVENTORISATION_POSITIVE_REASONS
                : MAP_OF_INVENTORISATION_NEGATIVE_REASONS
            "
            required
           
            bindValue="value"
            bindLabel="label"
            [(ngModel)]="row.reason"
            [searchable]="false"
            [clearable]="false"
          >
          </ng-select>
          </div>
          
        </ng-template>
      </app-table>
    </ng-container>
  </div>
</ng-container>
